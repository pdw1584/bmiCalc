<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Firebase Google Login</title>
    <!-- Firebase App (the core Firebase SDK) -->
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>
    <!-- Firebase Authentication -->
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth.js"></script>
    <!-- Firebase Firestore -->
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js"></script>
    <!-- Firebase database -->
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js"></script>
    
</head>
<body>
    <button onclick="googleLogin()">Google</button>
    <p id="message"></p>

    <script>
        // Firebase 프로젝트 구성
        const firebaseConfig = {
            apiKey: "AIzaSyD-vvavfui-_KupcdPWBDnUeoNQy1-BPVg",
            authDomain: "test-24623.firebaseapp.com",
            projectId: "test-24623",
            storageBucket: "test-24623.appspot.com",
            messagingSenderId: "708516517803",
            appId: "1:708516517803:web:5ba72a9ae556b20daa64ee"
        };

        // Firebase 초기화
        firebase.initializeApp(firebaseConfig);

        // Firebase Authentication 및 Firestore 참조
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Google 로그인 함수
        async function googleLogin() {navigator
            const provider = new firebase.auth.GoogleAuthProvider();
            try {
                const result = await auth.signInWithPopup(provider);
                const user = result.user;

                // 사용자 정보 Firestore에 저장
                const userRef = db.collection('users').doc(user.uid);
                await userRef.set({
                    uid: user.uid,
                    displayName: user.displayName,
                    email: user.email,
                    photoURL: user.photoURL,
                }, { merge: true });

                // 로그인 성공 메시지
                document.getElementById('message').innerText = `Hello, ${user.displayName}`;
            } catch (error) {
                console.error(error);
                document.getElementById('message').innerText = `Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>
